---
- name: Installing Apt Packages
  become: yes
  apt:
    name:
      - curl
      - rlwrap
      - openjdk-11-jdk
      - leiningen
    state: present
    update_cache: yes

- name: Downloading Clojure Cli
  get_url:
    url: https://download.clojure.org/install/linux-install-1.10.3.855.sh
    dest: /tmp/clojure_installer
    mode: '0700'
    checksum: sha256:4bafe3c7343b7d4ef44bd0145bf4203be1c144a30d99a1db53ab67abb2568e2b

- name: Install Clojure Cli
  become: yes
  command: ./clojure_installer
  args:
    chdir: /tmp

- name: Downloading Clojure LSP
  get_url:
    url: https://raw.githubusercontent.com/clojure-lsp/clojure-lsp/master/install-latest-clojure-lsp.sh
    dest: /tmp/clojure_lsp_installer
    mode: '0700'
    checksum: sha256:88e7cc74c92ac3cb94ca685c4f8269886ea2bb8b330544f3507664e2af030e6c

- name: Install Clojure LSP
  become: yes
  command: ./clojure_lsp_installer
  args:
    chdir: /tmp

- name: Delete auto generated .clojure directory
  file:
    state: absent
    path: ~/.clojure

- name: Adding Clojure deps user local
  git:
    repo: https://github.com/Aljendro/clojure-deps-edn.git
    dest: ~/.clojure/
    depth: "1"

