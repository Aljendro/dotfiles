import path from 'path';
import fs from 'fs/promises';
import pick from 'lodash/pick.js';
import * as handlebarsUtilities from '../../utils/handlebars.js';

const { DOTFILES_DIR } = process.env;

/**
 * startProject handler
 */
export async function handler(argv) {
  const template = path.join(DOTFILES_DIR, '/some/template/path.txt');

  const data = pick(argv, []);

  /*
   * template
   */
  const startProjectTemplateToFilepath = `${process.cwd()}/some/output/path`;
  await handlebarsUtilities.renderAt(template, {
    toFilepath: startProjectTemplateToFilepath,
    data,
  });
  await fs.chmod(startProjectTemplateToFilepath, '700');
}
